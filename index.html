<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JaguarBet - Canlı Skor & İstatistik</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-color: #D32F2F; --primary-hover-color: #B71C1C; --live-text-color: #D32F2F; --favorite-color: #ffc107; --goal-flash-bg: #D32F2F; --background-color: #121212; --surface-color: #1E1E1E; --surface-highlight-color: #2A2A2A; --text-color: #E0E0E0; --text-muted-color: #B0B0B0; --border-color: #333333; --danger-color: #FF4D4D; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Roboto', sans-serif; background: var(--background-color); color: var(--text-color); line-height: 1.5; font-size: 15px; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        header { display: flex; justify-content: space-between; align-items: center; background: var(--surface-color); padding: 1rem; font-size: 1.8rem; font-family: 'Orbitron', sans-serif; color: var(--primary-color); border-bottom: 3px solid var(--primary-color); box-shadow: 0 4px 12px rgba(211, 47, 47, 0.1); }
        #auth-section button, .form-group button, .card button { background: var(--primary-color); color: white; border:none; padding: 8px 12px; font-size: 0.9rem; border-radius: 5px; cursor: pointer; margin-left: 10px; font-weight: bold; }
        .tabs { display: flex; background-color: var(--surface-highlight-color); border-bottom: 1px solid var(--border-color); overflow-x: auto; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
        .tabs::-webkit-scrollbar { display: none; }
        .tab-button { padding: 0.8rem 1.2rem; cursor: pointer; border: none; background-color: transparent; color: var(--text-muted-color); font-size: 0.9rem; font-weight: 500; transition: all 0.25s ease-in-out; border-bottom: 3px solid transparent; white-space: nowrap; }
        .tab-button.active { color: var(--primary-color); border-bottom-color: var(--primary-color); font-weight: 700; }
        .tab-button:hover:not(.active) { color: var(--text-color); background-color: rgba(255,255,255,0.05); }
        .tab-content { display: none; padding-top: 1rem; }
        .tab-content.active { display: block; }
        .card { background: var(--surface-color); padding: 1.5rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); margin-bottom: 1.5rem; border: 1px solid var(--border-color); }
        .card-header { font-size: 1.25rem; margin: -1.5rem -1.5rem 1.5rem; padding: 1rem 1.5rem; color: var(--primary-color); border-bottom: 1px solid var(--border-color); background-color: var(--surface-highlight-color); border-radius: 8px 8px 0 0; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; align-items: end; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { margin-bottom: 0.4rem; font-weight: 500; font-size: 0.85rem; color: var(--text-muted-color); }
        .form-group select, .form-group input, input[type="date"] { padding: 0.7rem 0.8rem; background-color: var(--surface-highlight-color); color: var(--text-color); border: 1px solid var(--border-color); border-radius: 5px; font-family: inherit; font-size: 0.9rem; width: 100%; }
        .card button:hover, .form-group button:hover { background-color: var(--primary-hover-color); }
        .league-group-header { display: flex; align-items: center; padding: 0.7rem 1rem; background-color: var(--surface-highlight-color); border-radius: 6px 6px 0 0; margin-top: 1.2rem; border-bottom: 1px solid var(--border-color); }
        .league-group-header:first-child { margin-top: 0; }
        .league-flag { width: 22px; height: auto; margin-right: 10px; border-radius: 3px; object-fit: cover; }
        .league-info .league-name { font-size: 1rem; font-weight: 700; color: var(--text-color); }
        .league-info .country-name { font-size: 0.8rem; color: var(--text-muted-color); }
        .match-row { display: flex; align-items: center; padding: 0.8rem 1rem; border-bottom: 1px solid var(--border-color); background-color: var(--surface-color); transition: background-color 0.2s ease; position: relative; overflow: hidden; }
        .league-matches .match-row:last-child { border-bottom: none; border-radius: 0 0 6px 6px; }
        .match-row:hover { background-color: var(--surface-highlight-color); }
        .match-status { font-size: 0.85rem; color: var(--text-muted-color); font-weight: 700; width: 40px; text-align: center; margin-right: 0.8rem; }
        .match-teams { flex-grow: 1; margin-right: 0.8rem; }
        .team-line { display: flex; align-items: center; margin-bottom: 0.3rem; position: relative; }
        .team-line:last-child { margin-bottom: 0; }
        .team-logo { width: 18px; height: 18px; margin-right: 8px; object-fit: contain; }
        .team-name { font-size: 0.9rem; color: var(--text-color); }
        .match-scores { display: flex; flex-direction: column; align-items: center; width: 25px; }
        .score-value { font-size: 1rem; font-weight: 700; color: var(--text-color); }
        .favorite-toggle { cursor: pointer; font-size: 1.4rem; line-height: 1; color: #555; transition: color 0.2s, transform 0.2s; margin-left: 1rem; padding: 5px; user-select: none; }
        .favorite-toggle:hover { transform: scale(1.2); }
        .favorite-toggle.is-favorite { color: var(--favorite-color); }
        .favorite-toggle.favorite-animate { animation: favorite-pop 0.3s ease-in-out; }
        @keyframes favorite-pop { 0% { transform: scale(1); } 50% { transform: scale(1.4); } 100% { transform: scale(1); } }
        #favorite-alert { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: var(--surface-color); color: var(--primary-color); border: 1px solid var(--primary-color); border-radius: 8px; padding: 12px 32px; font-size: 1rem; z-index: 3000; box-shadow: 0 4px 16px rgba(0,0,0,0.15); display: none; opacity: 0; transition: opacity 0.3s; }
        #loading-indicator, .content-loader { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(0,0,0,0.85); color: var(--primary-color); padding: 20px 30px; border-radius: 10px; font-size: 1rem; z-index: 2000; display: none; text-align: center; flex-direction: column; align-items: center; justify-content: center; }
        .content-loader { position: static; transform: none; background: transparent; padding: 2rem; }
        .loader { border: 4px solid #f3f3f330; border-radius: 50%; border-top: 4px solid var(--primary-color); width: 28px; height: 28px; animation: spin 1s linear infinite; margin: 0 auto 8px auto; }
        .table-responsive { overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table { width: 100%; border-collapse: collapse; margin-top: 1rem; font-size: 0.9rem; }
        th, td { text-align: left; padding: 0.8rem; border-bottom: 1px solid var(--border-color); }
        th { background-color: var(--surface-highlight-color); font-weight: 700; color: var(--primary-color); }
        tbody tr:hover { background-color: var(--surface-highlight-color); }
        td img { width: 20px; height: 20px; margin-right: 8px; vertical-align: middle; }
        #profile-button { display: flex; align-items: center; gap: 8px; background-color: transparent; border: 1px solid var(--border-color); padding: 6px 12px; font-size: 0.9rem; font-family: 'Roboto', sans-serif; font-weight: 500; cursor: pointer; }
        #profile-caret { font-size: 0.7em; transition: transform 0.2s ease-in-out; }
        #profile-button.open #profile-caret { transform: rotate(180deg); }
        #profile-menu { position: absolute; top: 100%; right: 0; margin-top: 10px; background-color: var(--surface-color); border: 1px solid var(--border-color); border-radius: 8px; width: 280px; box-shadow: 0 8px 16px rgba(0,0,0,0.3); z-index: 100; overflow: hidden; display: none; font-family: 'Roboto', sans-serif; font-size: 15px; }
        .profile-menu-header { padding: 1rem; border-bottom: 1px solid var(--border-color); background-color: var(--surface-highlight-color); }
        #menu-user-name { font-weight: 700; color: var(--text-color); }
        #menu-user-email { font-size: 0.85rem; color: var(--text-muted-color); word-break: break-all; }
        .profile-menu-item { padding: 0.8rem 1rem; display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; }
        .profile-menu-item strong { color: var(--text-muted-color); margin-right: 5px; }
        #menu-wallet-address { font-family: monospace; font-size: 0.8rem; background: var(--background-color); padding: 2px 5px; border-radius: 4px; word-break: break-all; }
        .profile-menu-value { font-weight: 700; color: var(--primary-color); }
        .profile-menu-link { display: block; padding: 0.8rem 1rem; text-align: center; background-color: var(--primary-hover-color); color: white; text-decoration: none; font-weight: 700; transition: background-color 0.2s; }
        .profile-menu-link:hover { background-color: var(--primary-color); }
        .notification-toggle-label { cursor: pointer; user-select: none; }
        .toggle-switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #555; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary-color); }
        input:focus + .slider { box-shadow: 0 0 1px var(--primary-color); }
        input:checked + .slider:before { transform: translateX(20px); }
    </style>
</head>
<body>
    <header>
        <span>⚽ JaguarBet</span>
        <div id="auth-section">
            <button id="google-login-btn">Google ile Giriş Yap</button>
            <button id="wallet-login-btn">Cüzdan ile Giriş Yap</button>
            <span id="login-loading" style="display:none; margin-left:10px; color:var(--primary-color); font-size:1.1rem; vertical-align:middle;">⏳</span>
            <div id="login-message" style="margin-top:0.5rem; font-size:0.95rem;"></div>
        </div>
        <div id="profile-section" style="display: none; position: relative;">
            <button id="profile-button">
                <span id="profile-name"></span>
                <span id="profile-caret">▼</span>
            </button>
            <div id="profile-menu" style="display: none;">
                <div class="profile-menu-header">
                    <div style="font-size:1.1rem; color:var(--primary-color); font-weight:bold; margin-bottom:0.3rem;">Hoş geldin!</div>
                    <div id="menu-user-name"></div>
                    <div id="menu-user-email"></div>
                </div>
                <div class="profile-menu-item" id="menu-wallet-address-container" style="display: none;">
                    <strong>Cüzdan Adresi:</strong>
                    <span id="menu-wallet-address"></span>
                </div>
                <div class="profile-menu-item">
                    <span>Ücretsiz Kupon:</span>
                    <span class="profile-menu-value">0</span>
                </div>
                <div class="profile-menu-item">
                    <span>Kazanılan Token:</span>
                    <span class="profile-menu-value">0</span>
                </div>
                <div class="profile-menu-item" id="notification-item" style="display: none;">
                    <label for="notification-switch" class="notification-toggle-label">Bildirimler</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notification-switch">
                        <span class="slider"></span>
                    </label>
                </div>
                <a href="#" class="profile-menu-link" id="logout-btn">Çıkış Yap</a>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="tabs">
            <button class="tab-button active" data-tab="live-scores-tab">Canlı Skorlar</button>
            <button class="tab-button" data-tab="scheduled-tab">Gelecek Maçlar</button>
            <button class="tab-button" data-tab="finished-tab">Bitmiş Maçlar</button>
            <button class="tab-button" data-tab="favorites-tab">⭐ Favorilerim</button>
            <button class="tab-button" data-tab="standings-tab">Puan Durumu</button>
        </div>

        <div id="live-scores-tab" class="tab-content active"><div id="live-matches-container"></div></div>

        <div id="scheduled-tab" class="tab-content">
            <div class="card">
                <div class="card-header">Tarihe Göre Maç Programı</div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="scheduled-date-select">Tarih</label>
                        <input type="date" id="scheduled-date-select">
                    </div>
                    <div class="form-group">
                        <button onclick="fetchFixtures('scheduled')">Programı Göster</button>
                    </div>
                </div>
            </div>
            <div id="scheduled-matches-container">
                 <div class="content-loader">Lütfen bir tarih seçip programı göster butonuna basın.</div>
            </div>
        </div>

        <div id="finished-tab" class="tab-content">
            <div class="card">
                <div class="card-header">Tarihe Göre Maç Sonuçları</div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="finished-date-select">Tarih</label>
                        <input type="date" id="finished-date-select">
                    </div>
                    <div class="form-group">
                        <button onclick="fetchFixtures('finished')">Sonuçları Göster</button>
                    </div>
                </div>
            </div>
            <div id="finished-matches-container">
                 <div class="content-loader">Lütfen bir tarih seçip sonuçları göster butonuna basın.</div>
            </div>
        </div>

        <div id="favorites-tab" class="tab-content"><div id="favorite-matches-container"></div></div>
        
        <div id="standings-tab" class="tab-content">
            <div class="card">
                <div class="card-header">Puan Durumu</div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="league-select">Lig</label>
                        <select id="league-select"></select>
                    </div>
                    <div class="form-group">
                        <label for="season-select">Sezon</label>
                        <select id="season-select"></select>
                    </div>
                    <div class="form-group">
                        <button onclick="fetchStandings()">Göster</button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="standings-table" style="display:none">
                        <thead>
                            <tr>
                                <th style="width:40px">#</th><th style="text-align:left">Takım</th><th>O</th><th>G</th><th>B</th><th>M</th><th>AG</th><th>YG</th><th>AV</th><th>P</th><th>Form</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div id="standings-message" class="content-loader">Lütfen lig ve sezon seçin</div>
            </div>
        </div>
    </div>
    
    <div id="loading-indicator"><div class="loader"></div>Veri Yükleniyor...</div>
    <div id="favorite-alert"></div>

    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js" type="application/javascript"></script>
    <script>
        const BACKEND_API_BASE = '/api/football'; // GÜNCELLENDİ: API path'i daha temiz hale getirildi
        let FCM_VAPID_PUBLIC_KEY = null;

        let userDbFavorites = new Set();
        let currentUser = null;
        let allMatchesData = {};
        let liveMatchIntervalId = null;
        const loadingIndicator = document.getElementById('loading-indicator');

        // --- TEMEL YARDIMCI FONKSİYONLAR ---
        const getGuestFavorites = () => new Set(JSON.parse(localStorage.getItem('guest_favorites') || '[]').map(Number));
        const saveGuestFavorites = (favsSet) => localStorage.setItem('guest_favorites', JSON.stringify(Array.from(favsSet)));
        const getCurrentFavorites = () => currentUser ? userDbFavorites : getGuestFavorites();
        const showLoading = () => loadingIndicator.style.display = 'flex';
        const hideLoading = () => loadingIndicator.style.display = 'none';
        const displayMessage = (containerId, message, isError = false) => {
            const container = document.getElementById(containerId);
            if (container) container.innerHTML = `<div class="content-loader" style="color: ${isError ? 'var(--danger-color)' : 'var(--text-muted-color)'};">${message}</div>`;
        };
        const parseJwt = (token) => { try { return JSON.parse(atob(token.split('.')[1])); } catch (e) { return null; } };
        const urlBase64ToUint8Array = (base64String) => {
            const padding = '='.repeat((4 - base64String.length % 4) % 4);
            const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');
            const rawData = window.atob(base64);
            const outputArray = new Uint8Array(rawData.length);
            for (let i = 0; i < rawData.length; ++i) { outputArray[i] = rawData.charCodeAt(i); }
            return outputArray;
        };

        // --- DATA FETCHING ---
        const fetchDataFromBackend = async (endpoint, options = {}) => {
            const response = await fetch(endpoint, options);
            if (!response.ok) throw new Error(`API Hatası: ${response.status}`);
            return response.json();
        };

        // --- RENDER FONKSİYONLARI ---
        const createLeagueHeaderElement = (league) => `
            <div class="league-group-header">
                <img src="${league.logo}" alt="${league.country}" class="league-flag">
                <div class="league-info">
                    <div class="league-name">${league.name}</div>
                    <div class="country-name">${league.country}</div>
                </div>
            </div>`;

        const createFixtureRowElement = (match) => {
            const { fixture, teams, goals } = match;
            allMatchesData[fixture.id] = match; // Tüm maçları merkezi bir yerde sakla
            const favorites = getCurrentFavorites();
            
            let statusText;
            const shortStatus = fixture.status.short;
            if (['FT', 'AET', 'PEN', 'CANC', 'ABD', 'PST'].includes(shortStatus)) {
                const statusMap = {'FT':'Bitti', 'AET':'Bitti (UZT)', 'PEN':'Bitti (PEN)', 'CANC':'İptal', 'ABD':'Terk Edildi', 'PST':'Ertelendi'};
                statusText = statusMap[shortStatus] || shortStatus;
            } else if (fixture.status.elapsed) {
                statusText = `<span style="color:var(--live-text-color);">${fixture.status.elapsed}'</span>`;
            } else {
                statusText = new Date(fixture.date).toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
            }

            return `
                <div class="match-row" id="match-${fixture.id}">
                    <div class="match-status">${statusText}</div>
                    <div class="match-teams">
                        <div class="team-line"><img src="${teams.home.logo}" class="team-logo">${teams.home.name}</div>
                        <div class="team-line"><img src="${teams.away.logo}" class="team-logo">${teams.away.name}</div>
                    </div>
                    <div class="match-scores">
                        <div class="score-value">${goals.home ?? '-'}</div>
                        <div class="score-value">${goals.away ?? '-'}</div>
                    </div>
                    <span class="favorite-toggle ${favorites.has(fixture.id) ? 'is-favorite' : ''}" data-fixture-id="${fixture.id}" onclick="toggleFavorite('${fixture.id}', event)">★</span>
                </div>`;
        };
        
        const renderFixtures = (container, matches, type) => {
            const messageMap = {
                'live': 'Şu anda canlı maç bulunmuyor.',
                'scheduled': 'Seçilen tarihte oynanacak maç bulunamadı.',
                'finished': 'Seçilen tarihte bitmiş maç bulunamadı.',
                'favorites': 'Favori maçlarınız şu an canlı değil veya veri yüklenemedi.'
            };
            if (!matches || matches.length === 0) {
                displayMessage(container.id, messageMap[type]);
                return;
            }

            const groupedByLeague = matches.reduce((acc, match) => {
                (acc[match.league.id] = acc[match.league.id] || []).push(match);
                return acc;
            }, {});
            
            let html = '';
            const sortedLeagueIds = Object.keys(groupedByLeague).sort((a,b) => groupedByLeague[a][0].league.name.localeCompare(groupedByLeague[b][0].league.name));

            for (const leagueId of sortedLeagueIds) {
                const leagueMatches = groupedByLeague[leagueId].sort((a,b) => new Date(a.fixture.date) - new Date(b.fixture.date));
                html += createLeagueHeaderElement(leagueMatches[0].league);
                html += leagueMatches.map(createFixtureRowElement).join('');
            }
            container.innerHTML = html;
        };

        // --- ÇEKME MANTIĞI ---
        const fetchLiveMatches = async (isUpdate = false) => {
            if (!isUpdate) showLoading();
            try {
                const data = await fetchDataFromBackend(`${BACKEND_API_BASE}/fixtures?live=all`);
                renderFixtures(document.getElementById('live-matches-container'), data.response, 'live');
                renderFavoriteMatches(); // Canlı maçlar güncellendiğinde favorileri de güncelle
            } catch (error) {
                console.error("Canlı maçlar çekilirken hata oluştu:", error);
                displayMessage('live-matches-container', 'Canlı maçlar yüklenirken bir sorun oluştu.', true);
            } finally {
                if (!isUpdate) hideLoading();
                updateAllFavoriteIcons();
            }
        };

        const fetchFixtures = async (type) => {
            const dateInput = document.getElementById(`${type}-date-select`);
            const container = document.getElementById(`${type}-matches-container`);
            const date = dateInput.value;
            if (!date) {
                showFavoriteAlert('Lütfen bir tarih seçin.');
                return;
            }
            container.innerHTML = `<div class="content-loader"><div class="loader"></div>Veriler Yükleniyor...</div>`;
            try {
                const data = await fetchDataFromBackend(`${BACKEND_API_BASE}/fixtures?date=${date}`);
                const matches = (type === 'finished')
                    ? data.response.filter(m => ['FT', 'AET', 'PEN', 'CANC', 'ABD', 'PST'].includes(m.fixture.status.short))
                    : data.response.filter(m => !['FT', 'AET', 'PEN', 'CANC', 'ABD', 'PST'].includes(m.fixture.status.short));
                renderFixtures(container, matches, type);
            } catch (error) {
                console.error(`${type} maçları çekilirken hata:`, error);
                displayMessage(container.id, 'Veriler yüklenirken bir sorun oluştu.', true);
            }
        };

        const renderFavoriteMatches = () => {
            const container = document.getElementById('favorite-matches-container');
            const favorites = getCurrentFavorites();
            if (favorites.size === 0) {
                displayMessage('favorite-matches-container', 'Henüz favori maçınız yok.<br>Maçların yanındaki yıldıza tıklayarak ekleyebilirsiniz.');
                return;
            }
            const favoriteMatches = Array.from(favorites).map(id => allMatchesData[id]).filter(Boolean);
            renderFixtures(container, favoriteMatches, 'favorites');
        };

        // --- AUTH & FAVORITES & NOTIFICATIONS ---
        // Bu fonksiyonlar önceki halinden büyük oranda aynı kalacak
        const loginWithGoogle = () => { window.location.href = `/api/auth/google`; };
        // loginWithWallet, logout, checkForLoggedInUser, loadUserFavorites, saveFavorites, toggleFavorite...
        // showFavoriteAlert, updateAllFavoriteIcons, ve bildirim fonksiyonları...
        // PUAN DURUMU FONKSİYONLARI (loadLeagues, loadSeasons, fetchStandings)
        // Hepsi burada yer almalı...

        // --- SAYFA BAŞLATMA ---
        const openTab = (event) => {
            const tabName = event.currentTarget.dataset.tab;
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(tb => tb.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');

            if (tabName === 'favorites-tab') {
                renderFavoriteMatches();
            }
        };

        const initializePage = async () => {
            if ('serviceWorker' in navigator) {
                try {
                    await navigator.serviceWorker.register('/service-worker.js');
                } catch(err) {
                    console.error('Service Worker kaydı başarısız:', err);
                }
            }
            
            document.querySelectorAll('.tab-button').forEach(button => button.addEventListener('click', openTab));
            // Diğer event listener'lar (login, logout, profil vs.) burada ayarlanmalı

            // Tarih seçicilere varsayılan tarihleri ata
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            document.getElementById('scheduled-date-select').value = today.toISOString().split('T')[0];
            document.getElementById('finished-date-select').value = yesterday.toISOString().split('T')[0];
            
            // await loadConfig(); // VAPID key için
            await checkForLoggedInUser();
            await fetchLiveMatches();
            await loadLeagues();
            await loadSeasons();
            
            liveMatchIntervalId = setInterval(() => fetchLiveMatches(true), 120000);
        };
        
        // Bu alana, yukarıda belirtilen ama yer kaplamaması için eklenmeyen
        // tüm Auth, Favorites, Notifications ve Standings fonksiyonlarını
        // önceki kodunuzdan kopyalayıp yapıştırmanız gerekmektedir.
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>